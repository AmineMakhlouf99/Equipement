{% extends 'base.html.twig' %} 

{% block title %}Liste de PVs{% endblock %}

{% block body %}
<div class="container my-5">
    <h2 class="text-center mb-4">Liste des Affectations sous Procès-Verbal</h2>
    
    <table class="table table-bordered table-striped" id="myTable">
        <thead class="table-dark">
            <tr>
                <th scope="col" onclick="sortTable(0)">Numéro du PV</th>
                <th scope="col" onclick="sortTable(1)">Nom de l'Équipement</th>
                <th scope="col" onclick="sortTable(2)">Affecté à</th>
                <th scope="col" onclick="sortTable(3)">Type de Bénéficiaire</th>
                <th scope="col" onclick="sortTable(4)">Date d'Affectation</th>
                <th scope="col" onclick="sortTable(5)">Statut de Disponibilité</th>
                <th scope="col" onclick="sortTable(6)">Statut de Condition</th>
                <th scope="col" style="width: 100px;">Actions</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            {% for pvAffectation in pvAffectations %}
            <tr>
                <td>{{ pvAffectation.id }}</td>
                <td>{{ pvAffectation.materiel.nom }}</td>
                <td>
                    {% if pvAffectation.collaborateur %}
                        {{ pvAffectation.collaborateur.nom }}
                    {% elseif pvAffectation.fournisseur %}
                        {{ pvAffectation.fournisseur.nom_entreprise }}
                    {% else %}
                        Non attribué
                    {% endif %}
                </td>
                <td>
                    {% if pvAffectation.collaborateur %}
                        Collaborateur
                    {% elseif pvAffectation.fournisseur %}
                        Fournisseur
                    {% else %}
                        Non défini
                    {% endif %}
                </td>
                <td>{{ pvAffectation.date_debut_affectation|date('Y-m-d') }}</td>
                <td>{{ pvAffectation.materiel.disponibilite }}</td>
                <td>{{ pvAffectation.materiel.etat }}</td>
                <td>
                    <a href="{{ path('pv.delete', { id: pvAffectation.id }) }}" class="btn btn-danger btn-sm">Supprimer</a>
                   <span>
                    <a href="{{ path('pv.info', { id: pvAffectation.id }) }}" class="btn btn-info btn-sm">Détails</a>
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <nav>
        <ul class="pagination justify-content-center" id="pagination">
            <!-- Pagination will be generated by JavaScript -->
        </ul>
    </nav>
</div>
<script>
$(document).ready(function() {
    $('#myTable').DataTable();
});
</script>

{% endblock %}
